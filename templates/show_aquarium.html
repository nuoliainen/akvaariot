<!DOCTYPE html>
<html>

<head>
  <title>Akvaario: {{ aquarium.name }}</title>
</head>

<body>
  {% include "session_info.html" %}
  {% include "navigation_bar.html" %}

  <h1>Akvaario: {{ aquarium.name }}</h1>
  {% if session.user_id == aquarium.user_id %}
    <a href="/edit_aquarium/{{ aquarium.id }}">Muokkaa</a>
    <a href="/remove_aquarium/{{ aquarium.id }}">Poista</a> <br />
    <a href="/images/{{ aquarium.id }}">Kuvat</a>
  {% endif %}

  <p>
    {% for image in images %}
      <img src="/image/{{ image.id }}" alt="Akvaarion kuva"/>
    {% endfor %}
  </p>

  <p>
    Akvaarion omistaja: <a href="/user/{{ aquarium.user_id }}">{{ aquarium.username }}</a>
  </p>

  <p>
    Akvaarion tilavuus: {{ aquarium.volume }} litraa 
    ({{ aquarium.length }} x {{ aquarium.depth }} x {{ aquarium.height }} cm)
  </p>

  <p>
    Akvaarion pystytyspäivämäärä:
    {% if aquarium.date %}
      {{ aquarium.date[8:10] }}.{{ aquarium.date[5:7] }}.{{ aquarium.date[:4] }}<br />
    {% else %}
      <i>ei ilmoitettu</i>
    {% endif %}
  </p>

  <p>
    {% if classes %}
      Luokittelu:
      <ul>
        {% for class in classes %}
          <li>{{ class.title }}: {{ class.value }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </p>

  <p>
    Kuvaus:
    <p>{{ aquarium.description | show_lines }}</p>
  </p>

  <h2>Eläimet:</h2>
  <p>
    {% if critters %}
    <ul>
      {% for critter in critters %}
        <li>
          {{ critter.species }} ({{ critter.count }})
          {% if session.user_id == aquarium.user_id %}
            <a href="/remove_critter/{{ critter.id }}">Poista</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    {% else %}
      <i>Akvaario on tyhjä</i>
    {% endif %}

    {% if session.user_id == aquarium.user_id %}
      <p>
        <a href="/new_critter">Lisää eläin</a>
        {% if critters %}
        <a href="/remove_critters/{{ aquarium.id }}">Tyhjennä akvaario</a>
        {% endif %}
      </p>
    {% endif %}
  </p>

  <h2>Kommentit</h2>
  {% for message in get_flashed_messages() %}
    <p>
      <b>{{ message }}</b>
    </p>
  {% endfor %}

  {% if comments %}
    <hr />
    {% for comment in comments %}
      <p>
        <a href="/user/{{ comment.user_id }}">{{ comment.username }}</a> ({{ comment.sent_at }}):
      </p>
      <p>
        {{ comment.content | show_lines }}
      </p>
      {% if session.user_id == comment.user_id %}
        <a href="/remove_comment/{{ comment.id }}">Poista</a>
      {% endif %}
      <hr />
    {% endfor %}
  {% else %}
    <p>Ei vielä kommentteja</p>
  {% endif %}

  {% if session.username %}
    <h2>Lisää kommentti</h2>
    <form action="/create_comment" method="post">
      <textarea name="content" rows="10" cols="60" maxlength="5000" required></textarea> <br />
      <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}" />
      <input type="hidden" name="aquarium_id" value="{{ aquarium.id }}" />
      <input type="submit" value="Lähetä" />
    </form>
  {% endif %}

</body>

</html>
